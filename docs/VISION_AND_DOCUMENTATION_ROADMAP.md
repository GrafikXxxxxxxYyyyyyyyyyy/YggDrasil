# Визия: золотой стандарт и самый удобный фреймворк — дорожная карта документации

**Канон проекта:** [CANON.md](../WorldGenerator_2.0/CANON.md) — единый всеобъемлющий канон архитектуры (WorldGenerator_2.0/); ему необходимо следовать, он допускает уточнение и расширение.

В этом документе перечислено, **что добавить и улучшить в документации проекта**, чтобы YggDrasill стал:

1. **Золотым стандартом** для диффузионных моделей и генерации миров (референсная архитектура, ясность понятий, полнота).
2. **Самым удобным фреймворком** среди созданных (лучший опыт разработчика, минимум трения, понятный онбординг).

Аудитория: сопровождающие и контрибьюторы при планировании документов; пользователи при оценке проекта.

---

## 1. Позиционирование и визия (документы для добавления)

### 1.1 Зачем YggDrasill / Сравнение с альтернативами

- [ ] **WHY_YGGDRASILL.md** (или раздел в README): одна страница «зачем этот фреймворк»:
  - **Единая иерархия:** Block → Graph → Pipeline → Stage → World; один контракт (`get_input_spec`, `get_output_spec`, `run`) на каждом уровне; нет разрыва между «библиотекой диффузии» и «оркестрацией».
  - **Сериализация на каждом уровне:** конфиг + чекпоинт от блока до мира; загрузка из чекпоинта на любом уровне.
  - **Мир как объект первого класса:** мир не «приложен»; Scheme (Философ → Автор → Среда → Архитектор → Творец) в каноне; state, цикл и условия — часть дизайна.
  - **LLM + диффузия + API:** поддержка LLM по API (без локальных весов), диффузионных бэкбонов и multi-endpoint в одном стеке.
  - **Полная гибкость и классические сценарии:** пользователь может использовать движок на любом уровне в классических сценариях в рамках единого канона; агентные системы полностью интегрированы. **Гиперграф** — основной движок; **крупномасштабные гиперссылки** — для связывания контекстов и взаимодействия. **End Worlds** — фиксированные миры (напр. книга), к которым можно привязываться; объектный мир обогащает контекст и истории, End World не меняется. Расширение: уровень Вселенной (гиперграф миров, кросс-мировое влияние, End Worlds).
- [ ] **COMPARISON.md**: нейтральная сравнительная таблица (возможности, не маркетинг):
  - с «только диффузия» (например, в стиле diffusers): YggDrasill = граф + пайплайн + мир, а не только forward модели;
  - с «только оркестрация» / workflow: YggDrasill = нативные обучаемые блоки, чекпоинты и семантика мира;
  - с «монолитными симуляторами мира»: YggDrasill = композируемый Lego, одна и та же сериализация и контракт run на всех уровнях;
  - Строки: уровни иерархии, уровни сериализации, модель мира/state, поддержка LLM (локально + API), multi-endpoint, обучаемость, сборка из конфига.

### 1.2 Обоснование решений (почему такая форма)

- [ ] **DESIGN_RATIONALE.md**: краткое обоснование ключевых решений:
  - почему «один граф = одна задача» и пайплайн = граф графов;
  - почему один и тот же I/O-контракт на всех уровнях;
  - почему DAG на уровне пайплайн/этап и цикл только на уровне мира;
  - почему блоки объявляют порты, а графы экспонируют их;
  - помогает новичкам и ревьюерам увидеть, что форма осознанная, а не случайная.

---

## 2. Онбординг и удобство (опыт разработчика)

### 2.1 Быстрый старт и путь «за 5 минут»

- [ ] **QUICKSTART.md** (или расширить корневой README):
  - Минимальный путь: установка → один блок → добавление в граф → expose I/O → run (один сниппет).
  - Путь через конфиг: тот же граф из YAML/JSON; один сниппет.
  - Пайплайн: два графа, одно ребро, run; один сниппет.
  - Мир: когда World реализован — «один цикл с мок-этапами» в несколько строк.
  - Без длинной теории сначала; «запустить что-то за 5 минут», затем ссылки на углублённые документы.

### 2.2 Глоссарий и единые термины

- [ ] **GLOSSARY.md**: одно место для терминов по канону и коду:
  - Block, Node, Edge, Port, Graph, Pipeline, Stage, World;
  - внешний вход/выход, контракт, run, checkpoint, state (state мира vs. состояние обучения);
  - Backbone, Solver, Codec, Conditioner, Tokenizer, Adapter, Guidance (и роли);
  - DAG, цикл, топология, буфер, execution_condition;
  - Одно предложение на термин + ссылка на канонический документ.

### 2.3 Документированные «счастливые пути» (рецепты)

- [ ] **COOKBOOK.md** или **examples/README.md** с рецептами:
  - «Граф text-to-image из конфига и run».
  - «Пайплайн: text-to-image → upscale, save/load».
  - «Добавить свой блок и зарегистрировать».
  - «Узел LLM через API (без локальных весов)».
  - «Валидация графа и пайплайна перед run».
  - «Обучить один узел в графе и сохранить чекпоинт».
  - Для каждого: цель, минимальный код/конфиг, ожидаемый результат, ссылка на API/канон.

### 2.4 Решение проблем и FAQ

- [ ] **TROUBLESHOOTING.md**: типичные ошибки и исправления:
  - «Port not in spec» / «node not found» при добавлении рёбер;
  - «Pipeline has a cycle» / валидация DAG;
  - «Missing required input» при run;
  - Загрузка/сохранение чекпоинта (путь, формат, backend);
  - Config ref и from_yaml (файл не найден, кодировка).
- [ ] **FAQ.md**: короткие ответы на частые вопросы:
  - Когда использовать Graph vs Pipeline vs Stage?
  - Можно ли смешивать локальный и API LLM в одном графе?
  - Как добавить новый тип блока?
  - Где хранится state мира?

---

## 3. Полнота и «золотой стандарт»

### 3.1 Обзор API (стабильная поверхность)

- [ ] **API_OVERVIEW.md**: список **публичных точек входа**, считающихся стабильными: `Graph`, `Pipeline`, `run`, `get_input_spec`, `get_output_spec`, `from_config`, `save`, `load`, `validate` и т.д.; одна строка на символ + ссылка на реализацию или DONE.

### 3.2 Схема и справочник конфигов

- [ ] **CONFIG_REFERENCE.md**: структура конфига графа, пайплайна (и далее этапа/мира); поля nodes, edges, exposed_inputs, exposed_outputs, metadata; опционально JSON Schema или сводка Pydantic.

### 3.3 Нарратив по тестам и качеству

- [ ] **TESTING.md**: что тестируется (foundation, pipeline, валидация); как запускать тесты и как добавлять тесты для нового блока/графа; контрактные тесты при наличии.

### 3.4 Версионирование и совместимость

- [ ] **VERSIONING.md** или **CHANGELOG.md** + раздел в README: политика семантического версионирования; совместимость конфига и чекпоинта; миграция при смене схемы.

---

## 4. Структура и навигация

### 4.1 Единая «карта документов» и пути чтения

- [ ] **DOC_MAP.md** (или раздел «Документация» в README):
  - По роли: «хочу использовать» → Quick Start, Cookbook, API Overview; «хочу понять дизайн» → Philosophy, System, Scheme, Design Rationale; «хочу реализовывать/расширять» → TODO_*, DONE_*, канон, LLM_API_SUPPORT, MODEL_REUSE, TRAINING_REUSE_AND_API_SCENARIOS, AGENT_SYSTEMS_SUPPORT, SERIALIZATION, MULTI_ENDPOINT.
  - По уровню: Block/Node → Graph → Pipeline → Stage → World; для каждого — концепт, API, DONE/TODO.
  - По теме: диффузия, генерация мира, LLM, API-провайдеры (любой блок), сериализация, обучение, повторное использование моделей, LoRA и API, **агентные системы** (агент, инструменты, agent_loop), multi-endpoint.

### 4.2 README как «главная страница»

- [ ] В корневом README добавить (сохранив текущие принципы):
  - Одно короткое «Что такое YggDrasill» (1–2 предложения).
  - Ссылку «Быстрый старт» и один минимальный рабочий пример (граф или пайплайн).
  - Раздел «Документация»: ссылка на DOC_MAP или список (Quick Start, канон, реализация, визия и дорожная карта).

---

## 5. Мир и диффузия как «золотой стандарт»

### 5.1 Генерация мира как референс

- [ ] **WORLD_GENERATION_GUIDE.md** (когда World реализован): как устроен цикл мира (Scheme), как течёт state, когда выполняется каждый этап; как задать минимальный мир и запустить один цикл; как подключить LLM (API) и диффузионные графы к этапам.

### 5.2 Диффузия в стеке

- [ ] **DIFFUSION_IN_YGGDRASILL.md**: где в стеке живёт диффузия (Backbone, Solver, Codec, Conditioner как блоки в графе); как добавить новый солвер или бэкбон; как чекпоинты и обучение вписываются в граф и пайплайн; опционально таблица «концепт (DDIM и т.д.) → роль → тип блока → контракт портов».

---

## 6. Сводный чеклист

| Область | Документ / изменение | Цель |
|--------|------------------------|------|
| Позиционирование | WHY_YGGDRASILL.md, COMPARISON.md | Нарратив «золотой стандарт»; отличие от других. |
| Дизайн | DESIGN_RATIONALE.md | Доверие к архитектуре. |
| Онбординг | QUICKSTART.md, COOKBOOK.md | «Самый удобный» на практике. |
| Ясность | GLOSSARY.md, FAQ.md, TROUBLESHOOTING.md | Меньше трения, единый язык. |
| Полнота | API_OVERVIEW.md, CONFIG_REFERENCE.md, TESTING.md, VERSIONING.md | Стабильная поверхность. |
| Навигация | DOC_MAP.md, разделы в README | Быстро найти нужный документ. |
| Мир / диффузия | WORLD_GENERATION_GUIDE.md, DIFFUSION_IN_YGGDRASILL.md | Референс для генерации миров и диффузии. |

Внедрение по приоритету (например: Quick Start → Doc Map → Glossary → Cookbook → Why/Comparison → остальное) приблизит проект к образу «золотой стандарт для диффузии и генерации миров» и «самый удобный фреймворк» без изменения кода.
