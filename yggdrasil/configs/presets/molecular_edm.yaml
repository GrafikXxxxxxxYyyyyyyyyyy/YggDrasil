# YggDrasil Preset: Molecular EDM (Equivariant Diffusion Model)
# Модальность: Молекулы (3D координаты + типы атомов)
# Процесс: Score-based SDE

_meta:
  name: "Molecular EDM"
  modality: molecular
  description: "Equivariant Diffusion for molecule generation (EDM-style)"

model:
  type: model/modular
  id: molecular_edm

  backbone:
    type: backbone/egnn           # E(n)-equivariant GNN
    hidden_dim: 256
    num_layers: 9
    num_heads: 4

  codec:
    type: codec/identity          # Без кодека — работаем напрямую с координатами
  
  conditioner:
    type: conditioner/molecular_property   # Условие на свойства молекулы
    property_dim: 64

  guidance:
    type: guidance/cfg
    scale: 2.0

diffusion_process:
  type: diffusion/process/ddpm
  num_train_timesteps: 1000

solver:
  type: diffusion/solver/ddim

sampler:
  num_inference_steps: 1000
  guidance_scale: 2.0

training:
  loss: training/loss/score
  learning_rate: 1.0e-4
  batch_size: 64
  mixed_precision: "no"
  train_mode: full
